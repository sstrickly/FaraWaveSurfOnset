function [ aon ] = AonGSurfHFinOrd2( omega0 , k0 , epsilon , M , B , Di , H , Sigma , ~ )
% AonGSurfHFinOrd2 returns the dimensional onset acceleration for the second-order surfactant-covered finite-depth case.  This is the general case.
%
% In this context Di = 1/Pe and does not equal the diffusivity.

VH = + 2 * Sigma * cosh(2*H) ...
     + sinh(2*H) ...
     + 2 * H ...
     - 2 * Sigma;

VS = 1 ...
    + sqrt(2) * B ...
    + B^2 ...
    + M*( ...
        sqrt(2) ...
        + 2 * B ...
        + M / Di ...
        - sqrt(2) / Di ...
    )/( ...
        1/Di ...
        + Di ...
    );

N1 = ...
    (1 + Di^2)^3 * ( ...
        8 ...
        + 20 * sqrt(2) * B ...
        + 48 * B^2 ...
        + 34 * sqrt(2) * B^3 ...
        + 30 * B^4 ...
        + 8 * sqrt(2) * B^5 ...
        + 2 * B^6 ...
    ) ...
    + (1 + Di^2)^2 * M * ( ...
        - 20 * sqrt(2) ...
        - 68 * B ...
        - 54 * sqrt(2) * B^2 ...
        - 44 * B^3 ...
        - 8 * sqrt(2) * B^4 ...
        + M * ( ...
            + 48 ...
            + 102 * sqrt(2) * B ...
            + 180 * B^2 ...
            + 80 * sqrt(2) * B^3 ...
            + 30 * B^4 ...
        ) ...
    ) ...
    +(1 + Di^2) * M^2 * ( ...
        - 48 * sqrt(2) * B ...
        - 120 * B^2 ...
        - 64 * sqrt(2) * B^3 ...
        - 24 * B^4 ...
        + M * ( ...
            - 54 * sqrt(2) ...
            - 132 * B ...
            - 48 * sqrt(2) * B^2 ...
        ) ...
        + M^2 * ( ...
            + 30 ...
            + 40 * sqrt(2) * B ...
            + 30 * B^2 ...
        ) ...
    ) ...
    + M^3 * ( ...
        + 20 * sqrt(2) ...
        + 88 * B ...
        + 32 * sqrt(2) * B^2 ...
    ) ...
    + M^4 * ( ...
        - 32 * sqrt(2) * B ...
        - 24 * B^2 ...
    ) ...
    - 8 * sqrt(2) * M^5 ...
    + 2 * M^6 ...
    + (1 + Di^2)^2 * M * Di * ( ...
        + 20 * sqrt(2) ...
        + 96 * B ...
        + 102 * sqrt(2) * B^2 ...
        + 120 * B^3 ...
        + 40 * sqrt(2) * B^4 ...
        + 12 * B^5 ...
    ) ...
    + (1 + Di^2) * M^2 * Di * ( ...
        - 68 ...
        - 108 * sqrt(2) * B ...
        - 132 * B^2 ...
        - 32 * sqrt(2) * B^3 ...
        + M * ( ...
            + 34 * sqrt(2) ...
            + 120 * B ...
            + 80 * sqrt(2) * B^2 ...
            + 40 * B^3 ...
        ) ...
    ) ...
    + M^3 * Di * ( ...
        + 20 * sqrt(2) ...
        - 32 * sqrt(2) * B^2 ...
        - 16 * B^3 ...
    ) ...
    + M^4 * Di * ( ...
        - 44 ...
        - 32 * sqrt(2) * B ...
    ) ...
    + M^5 * Di * ( ...
        + 8 * sqrt(2) ...
        + 12 * B ...
    );
N2 = ...
    N1 ...
    + ( 1 + Di^2 )^3 * B^3 * ( ...
        + 2 * sqrt(2) ...
        + 4 * B ...
    ) ...
    + (1 + Di^2)^2 * B * M * ( ...
        - 4 ...
        + 2 * sqrt(2) * M ...
        - 4 * sqrt(2) * B ...
        + 12 * B * M ...
        - 8 * B^2 ...
        - 6 * sqrt(2) * B^3 ...
    ) ...
    + (1 + Di^2)^2 * B * M * Di * ( ...
        + 4 * sqrt(2) * B ...
        + 12 * B^2 ...
    ) ...
    + (1 + Di^2) * B * M * ( ...
        + 16 * sqrt(2) * M ...
        - 16 * M^2 ...
        + 24 * B * M ...
        - 24 * sqrt(2) * B * M^2 ...
        + 8 * B^2 ...
        + 4 * sqrt(2) * B^3 ...
    ) ...
    + (1 + Di^2) * B * M * Di * ( ...
        - 4 * sqrt(2) * M ...
        + 4 * M^2 ...
        + 4 * sqrt(2) * B ...
        - 20 * B * M ...
        + 8 * B^2 ...
        - 20 * sqrt(2) * B^2 * M ...
    ) ...
    + M^2 * ( ...
        - 4 * sqrt(2) * M ...
        + 8 * M^2 ...
        - 2 * sqrt(2) * M^3 ...
        - 16 * sqrt(2) * B ...
        + 16 * B * M ...
        - 24 * B^2 ...
        + 20 * sqrt(2) * B^2 * M ...
    ) ...
    + M^2 * Di * ( ...
        - 8 ...
        + 8 * sqrt(2) * M ...
        - 4 * M^2 ...
        - 8 * sqrt(2) * B ...
        + 32 * B * M ...
        - 12 * sqrt(2) * B * M^2 ...
        + 16 * B^2 ...
        + 8 * sqrt(2) * B^3 ...
    ) ...
    ;



L1 = N1/2;

% Defined out of numerical order but in order of ease to define.
L3 = ...
    (1 + Di^2)^3 * ( ...
        + 4 ...
        + 17 * B^4 ...
        + B^6 ...
    ) ...
    + (1 + Di^2)^2 * M * ( ...
        + 2 * ( ...
            - 5 * sqrt(2) ...
            + 5 * sqrt(2) * Di ...
            + 12 * M ...
        ) ...
        + B^4 * ( ...
            - 7 * sqrt(2) ...
            + 20 * sqrt(2) * Di ...
            + 15 * M ...
        ) ...
    ) ...
    + M^2 * ( ...
        M * ( ...
            + 8 * sqrt(2) ...
            + 4 * M ...
            - 5 * sqrt(2) * M^2 ...
            + M^3 ...
        ) ...
        + 2 * Di * ( ...
            - 2 ...
            + 7 * sqrt(2) * M ...
            - 12 * M^2 ...
            + 2 * sqrt(2) * M^3 ...
        ) ...
    ) ...
    + (1 + Di^2) * M * ( ...
        + 2 * B^4 * ( ...
            + sqrt(2) ...
            - 6 * M ...
        ) ...
        + M * ( ...
            3 * M * ( ...
                - 9 * sqrt(2) ...
                + 5 * M ...
            ) ...
            + 17 * Di * ( ...
                - 2 ...
                + sqrt(2) * M ...
            ) ...
        ) ...
    ) ...
    ;

L2 = N2 - 2*L3 ;

L4 = ...
    (1 + Di^2)^3 * ( ...
        + 4 ...
        + 10 * sqrt(2) * B ...
        + 23 * B^2 ...
        + 14 * sqrt(2) * B^3 ...
        + 8 * B^4 ...
        - B^6 ...
    ) ...
    + (1 + Di^2)^2 * M * ( ...
        - 9 * sqrt(2) ...
        + 10 * sqrt(2) * Di ...
        - 6 * B^5 * Di ...
        + 8 * B^3 * ( ...
            - 1 ...
            + 4 * Di ...
        ) ...
        + B^4 * ( ...
            + sqrt(2) ...
            - 15 * M ...
        ) ...
        + 23 * M ...
        + 6 * B^2 * ( ...
            - 3 * sqrt(2) ...
            + 7 * sqrt(2) * Di ...
            + 8 * M ...
        ) ...
        + B * ( ...
            - 28 ...
            + 46 * Di ...
            + 42 * sqrt(2) * M ...
        ) ...
    ) ...
    - (1 + Di^2) * M^2 * ( ...
        + 4 ...
        - 12 * B^4 ...
        + 28 * Di ...
        - 4 * B^3 * Di * ( ...
            + sqrt(2) ...
            - 5 * M ...
        ) ...
        + 18 * sqrt(2) * M ...
        - 14 * sqrt(2) * Di * M ...
        - 8 * M^2 ...
        + 4 * B * ( ...
            + 6 * sqrt(2) ...
            + 9 * sqrt(2) * Di ...
            + 6 * M ...
            - 8 * Di * M ...
        ) ...
        + 3 * B^2 * ( ...
            + 12 ...
            + 8 * Di ...
            - 2 * sqrt(2) * M ...
            + 5 * M^2 ...
        ) ...
    ) ...
    + M^3 * ( ...
        + 8 * sqrt(2) ...
        + 4 * sqrt(2) * Di ...
        + 8 * B^3 * Di ...
        - 4 * B^2 * ( ...
            + sqrt(2) ...
            - 3 * M ...
        ) ...
        - 4 * M ...
        - 8 * Di * M ...
        + sqrt(2) * M^2 ...
        - M^3 ...
        + 2 * B * ( ...
            + 8 ...
            + Di * ( ...
                - 4 ...
                + 2 * sqrt(2) * M ...
                - 3 * M^2 ...
            ) ...
        ) ...
    ) ...
    ;

L5 = ...
    - 2 * (1 + Di^2)^3 * ( ...
        - 2 ...
        - 2 * sqrt(2) * B ...
        + 6 * B^2 ...
        + 17 * sqrt(2) * B^3 ...
        + 33 * B^4 ...
        + 16 * sqrt(2) * B^5 ...
        + 7 * B^6 ...
    ) ...
    - 2 * (1 + Di^2)^2 * M * ( ...
        + 2 * sqrt(2) ...
        - 2 * sqrt(2) * Di ...
        + 42 * B^5 * Di ...
        + 6 * M ...
        + 3 * B^2 * ( ...
            - 9 * sqrt(2) ...
            + 17 * sqrt(2) * Di ...
            + 66 * M ...
        ) ...
        + B^4 * ( ...
            - 16 * sqrt(2) ...
            + 80 * sqrt(2) * Di ...
            + 105 * M ...
        ) ...
        + B * ( ...
            - 10 ...
            + 12 * Di ...
            + 51 * sqrt(2) * M ...
        ) ...
        + 2 * B^3 * ( ...
            - 23 ...
            + 66 * Di ...
            + 80 * sqrt(2) * M ...
        ) ...
    ) ...
    + 2 * (1 + Di^2) * M^2 * ( ...
        + 84 * B^4 ...
        + 3 * M * ( ...
            + 9 * sqrt(2) ...
            - 11 * M ...
        ) ...
        + Di * ( ...
            + 10 ...
            - 17 * sqrt(2) * M ...
        ) ...
        + 4 * B^3 * ( ...
            + 32 * sqrt(2) ...
            + 16 * sqrt(2) * Di ...
            - 35 * Di * M ...
        ) ...
        + B^2 * ( ...
            + 132 ...
            + 138 * Di ...
            + 96 * sqrt(2) * M ...
            - 160 * sqrt(2) * Di * M ...
            - 105 * M^2 ...
        ) ...
        + 2 * B * ( ...
            + 12 * sqrt(2) ...
            + 27 * sqrt(2) * Di ...
            + 69 * M ...
            - 66 * Di * M ...
            - 40 * sqrt(2) * M^2 ...
        ) ...
    ) ...
    - 2 * M^3 * ( ...
        + 10 * sqrt(2) ...
        - 56 * B^3 * Di ...
        + B^2 * ( ...
            + 64 * sqrt(2) ...
            - 64 * sqrt(2) * Di ...
            - 84 * M ...
        ) ...
        - 16 * sqrt(2) * M^2 ...
        + 7 * M^3 ...
        + 2 * Di * ( ...
            + 5 * sqrt(2) ...
            - 23 * M ...
            + 8 * sqrt(2) * M^2 ...
        ) ...
        + B * ( ...
            + 92 ...
            - 64 * sqrt(2) * M * ( ...
                + 1 ...
                + Di ...
            ) ...
            + 42 * Di * M^2 ...
        ) ...
    ) ...
    ;

L6 = ...
    (1 + Di^2)^3 * ( ...
        + 28 * B^2 ...
        + 48 * sqrt(2) * B^3 ...
        + 95 * B^4 ...
        + 32 * sqrt(2) * B^5 ...
        + 15 * B^6 ...
    ) ...
    + 8 * B^3 * M^2 * Di * ( ...
        + 3 * sqrt(2) ...
        - 14 * M ...
    ) ...
    + 2 * Di * M^2 * ( ...
        - 14 ...
        + 33 * sqrt(2) * M ...
        - 68 * M^2 ...
        + 18 * sqrt(2) * M^3 ...
    ) ...
    + M^2 * ( ...
        - 16 ...
        + 24 * sqrt(2) * M ...
        + 28 * M^2 ...
        - 43 * sqrt(2) * M^3 ...
        + 15 * M^4 ...
    ) ...
    - 4 * B^2 * M^2 * ( ...
        + 18 ...
        - 47 * sqrt(2) * M ...
        + 42 * M^2 ...
        + 16 * Di * ( ...
            - 1 ...
            + 2 * sqrt(2) * M ...
        ) ...
    ) ...
    + (1 + Di^2)^2 * ( ...
        + 6 * sqrt(2) * Di * M ...
        + 84 * B^5 * Di * M ...
        - 6 * M * ( ...
            + sqrt(2) ...
            - 6 * M ...
        ) ...
        + 3 * B^4 * M * ( ...
            - 19 * sqrt(2) ...
            + 60 * sqrt(2) * Di ...
            + 75 * M ...
        ) ...
        + 2 * B^2 * M * ( ...
            - 47 * sqrt(2) ...
            + 65 * sqrt(2) * Di ...
            + 216 * M ...
        ) ...
        + 20 * B^3 * M * ( ...
            - 7 ...
            + 15 * Di ...
            + 16 * sqrt(2) * M ...
        ) ...
        + 4 * B * M * ( ...
            - 12 ...
            + 10 * Di ...
            + 29 * sqrt(2) * M ...
        ) ...
    ) ...
    + 4 * B * M^2 * ( ...
        - 16 * sqrt(2) ...
        + 66 * M ...
        - 32 * sqrt(2) * M^2 ...
        + Di * ( ...
            - 2 * sqrt(2) ...
            + 24 * M ...
            - 41 * sqrt(2) * M^2 ...
            + 21 * M^3 ...
        ) ...
    ) ...
    + (1 + Di^2) * ( ...
        + 2 * B^4 * M * ( ...
            + 7 * sqrt(2) ...
            - 90 * M ...
        ) ...
        + 3 * M^2 * ( ...
            + 8 ...
            - 31 * sqrt(2) * M ...
            + 27 * M^2 ...
        ) ...
        + Di * M * ( ...
            + 8 * sqrt(2) ...
            - 62 * M ...
            + 51 * sqrt(2) * M^2 ...
        ) ...
        + 4 * B * M * ( ...
            + 4 ...
            + 4 * sqrt(2) * M ...
            - 91 * M^2 ...
            + 40 * sqrt(2) * M^3 ...
            + Di * ( ...
                + 8 ...
                - 40 * sqrt(2) * M ...
                + 69 * M^2 ...
            ) ...
        ) ...
        + 4 * B^3 * M * ( ...
            + 10 ...
            - 64 * sqrt(2) * M ...
            + Di * ( ...
                + 6 ...
                - 47 * sqrt(2) * M ...
                + 70 * M^2 ...
            ) ...
        ) ...
        + 2 * B^2 * M * ( ...
            + 2 * Di * ( ...
                + 7 * sqrt(2) ...
                - 98 * M ...
                + 80 * sqrt(2) * M^2 ...
            ) ...
            + 3 * ( ...
                + 4 * sqrt(2) ...
                - 32 * M ...
                - 44 * sqrt(2) * M^2 ...
                + 35 * M^3 ...
            ) ...
        ) ...
    ) ...
    ;



aon = ( omega0^2 / k0 ) * ( ...
    epsilon * ( ...
        sqrt(2) * ( ...
            VS * csch(H)^2 ...
            + coth(H)^2 * ( ...
                VS ...
                - 1 ...
                + sqrt(2) * M / ( 1 + Di^2 ) ...
            ) ...
        )/( ...
            VS ...
        ) ...
    ) ...
    + epsilon^2 * ( ...
        ( ...
            coth(H) * ( ...
                cosh(2*H) * ( ...
                    4 * Sigma * L1 ...
                    + coth(H) * L2 ...
                ) ...
                + cosh(3*H) * csch(H) * L3 ...
                + 4 * H * L4 ...
                - 2 * Sigma * L5 ...
                + coth(H) * L6 ...
            ) ...
        )/( ...
            ( 1 + Di^2 )^3 ...
            * ( VS )^3 ...
            * VH ...
        ) ...
	) ...
    );


end


